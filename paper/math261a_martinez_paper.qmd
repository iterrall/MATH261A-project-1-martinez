---
title: "Linking Education, Unemployment, and Poverty"
subtitle: "Insights from California's CalEnviroScreen Data"
author: "Isis Martinez"
thanks: "Project repository available at: [https://github.com/iterrall/MATH261A-project-1-martinez](https://github.com/iterrall/MATH261A-project-1-martinez)."
date: today
date-format: long
format:
  pdf:
    number-sections: true
execute:
  echo: false
  warning: false
  message: false
  include: true
  fig-width: 4    # default width (in inches)
  fig-height: 3   # default height (in inches)
abstract: "We analyze the relationship between educational attainment and poverty in California with CalEnviroScreen 4.0, which is a statewide screening tool developed by the Office of Environmental Health Hazard Assessment (OEHHA). With a simple linear regression of census-tract location poverty rates on the percentage of adults without a high school diploma, we show that each one-point increase in low educational attainment is associated with an increase in poverty rate. This model shows about 61.6% of California tract-level variation in poverty, and is only minimally impacted when accounting for unemployment. This report will also share diagnostics of the model that indicate a lack of residual normality and variance constancy, so we interpret interval estimates with caution. These findings highlight the value of CalEnviroScreen for identifying socioeconomic vulnerability and informing policies aimed at reducing poverty and inequality."
bibliography: references.bib
body-footer: Math 261A - Regression Theory and Methods | Fall 2025 Project 1

---
```{r, include=FALSE}
#libraries
library(dplyr)
library(ggplot2)
library(broom)
library(scales)
library(qqplotr)
library(readr)
library(knitr)

#load data
raw_data <- read.csv("CalEnviroScreen_4.0_raw_data.csv")

#coerce to numeric & drop NAs
to_analyze_df_3vars <- raw_data %>%
  transmute(
    pov = suppressWarnings(as.numeric(pov)),
    edu = suppressWarnings(as.numeric(edu)),
    unemp = suppressWarnings(as.numeric(unemp))
  ) %>%
  filter(!is.na(pov), !is.na(edu), !is.na(unemp))

to_analyze_df <- raw_data %>%
transmute(
  pov = suppressWarnings(as.numeric(pov)),
  edu = suppressWarnings(as.numeric(edu))) %>%
filter(!is.na(pov), !is.na(edu))

# Set a global theme for all plots
theme_set(
  theme_minimal(base_size = 10) +
    theme(
      plot.title = element_text(face = "bold"),
      plot.caption = element_text(hjust = 0)
    )
)

#### Models #### 
set.seed(123) 
lm_fit <- lm(pov ~ edu, data=to_analyze_df) #predictor (x): edu, outcome (y): pov; simple linear regression (primary)
lm_fit2 <- lm(pov ~ edu + unemp, data=to_analyze_df_3vars) #predictor (x): edu, outcome (y): pov, for model with unemployment included 

# vars for inline references
n_obs    <- nobs(lm_fit)
coefs <- coef(lm_fit)
intercept <- coef(lm_fit)[1]
slope <- coef(lm_fit)[2] 
r2 <- summary(lm_fit)$r.squared
p_val <- broom::tidy(lm_fit) %>% 
  filter(term == "edu") %>% pull(p.value)

conf_int <- confint(lm_fit)["edu", ]

# Second model vars
n_obs2 <- stats::nobs(lm_fit2)
intercept2 <- coef(lm_fit2)[1]
slope2 <- coef(lm_fit2)["edu"]
r22 <- summary(lm_fit2)$r.squared

# Descriptive stats table
summ_tbl <- bind_rows(
to_analyze_df_3vars %>% summarize(
variable = "pov",
mean = mean(pov), sd = sd(pov), min = min(pov), p25 = quantile(pov, .25),
median = median(pov), p75 = quantile(pov, .75), max = max(pov), n = n()
),
to_analyze_df_3vars %>% summarize(
variable = "edu",
mean = mean(edu), sd = sd(edu), min = min(edu), p25 = quantile(edu, .25),
median = median(edu), p75 = quantile(edu, .75), max = max(edu), n = n()
),
to_analyze_df_3vars %>% summarize(
variable = "unemp",
mean = mean(unemp), sd = sd(unemp), min = min(unemp), p25 = quantile(unemp, .25),
median = median(unemp), p75 = quantile(unemp, .75), max = max(unemp), n = n()
)
) %>% mutate(across(mean:max, round, 2))
```
# Introduction {#sec-intro}
The link between educational attainment to socioeconomic well-being has been widely corroborated in research (for example, @cutler2006education and @zajacova2018). The persistent geographic inequities California faces drives the need for us to take a closer look at how education relates to poverty when related to location. Therefore, using the CalEnviroScreen 4.0 dataset, [@oehha_calenviroscreen_dataset], we ask the following question in this project: **To what extent is tract-level poverty associated with low levels of education in California?**

While its primary focus is to better understand and address environmental concerns in California communities, we can learn a great deal from the raw data that can be found on the CalEnviroScreen Data Hub [@oehha_calenviroscreen_dataset] about possible socioeconomic well-being predictors and outcomes. There is a wealth of information around geospatial data that can be used to drive more equitable decision-making by exploring possible factors that play a role in changes to poverty levels. Understanding this question can be an important way to learn poverty disparity mitigation techniques within communities to improve health, since low socioeconomic status has been tied to multiple environmental risks and health disparities [@OEHHA2021, @morello2006environmental].

We address this question by fitting a simple linear regression by taking poverty rate as a function of percentage of adults lacking a high school diploma. We then extend the analysis by exploring the contribution of unemployment makes on the model and examining the robustness of linear regression model assumptions.

The remainder of this paper is structured as follows: @sec-data discusses the data, @sec-methods the model and the methods we used, @sec-results presents the results, and @sec-discussion discusses the conclusions in addition to weaknesses with the conclusions from this model.

# Data {#sec-data}
We use California census tracts (locations) as our observational, as they serve as small, relatively stable geographic areas defined by the @acs_tech. We used this data that was compiled in the **CalEnviroScreen 4.0** [@OEHHA2021], which is a statewide screening tool that compiles socioeconomic, health, and environmental indicators to support policy and business decisions. 

We focus on the following socioeconomic measures drawn from the American Community Survey (@acs_tech, 2015â€“2019 5-year estimates) for this analysis [@OEHHA2021] from the CalEnviroScreen that was published in 2021 [@oehha_calenviroscreen_dataset]:

* **Poverty (pov)**: Percent of the tract population living below twice the federal poverty level (FPL). Using 200% of the FPL helps account for California's high cost of living [@oehha_calenviroscreen_dataset; @census_portal].

* **Education (edu)**: Percent of adults age 25 years and older without a high school diploma, which was derived as 100 minus the share of adults with at least a diploma [@acs_tech; @census_portal].

* **Unemployment (unemp)**: Percent of the labor force that is unemployed.

All variables are percentages in between 0 and 100, so we interpret coefficients as percentage-point changes. This means they represent expected changes in poverty rate per one-point percentage change in education (and employment in our supplementary model).

Before analysis, we removed tracts with missing values that were flagged as unreliable by OEHHA based on ACS standard error screening. After cleaning the raw data with @dplyr, the dataset contained `r n_obs` tracts for the primary model and `r n_obs2` for the supplemental model including unemployment.

```{r tbl-summ}
kable(summ_tbl, caption = 'Descriptive summaries for key variables (tract level).', booktabs = TRUE)
```

We note the **descriptive summaries** in the table @tbl-summ that we created using @robinson2014broom and @Xie2015. Across 7,658 tracts, the average poverty rate is `r summ_tbl$mean[summ_tbl$variable == "pov"]` %, with a wide range of values from `r summ_tbl$min[summ_tbl$variable == "pov"]` % to `r summ_tbl$max[summ_tbl$variable == "pov"]` %. Educational attainment shows large variability as well with an average `r summ_tbl$mean[summ_tbl$variable == "edu"]` of adults lacking a highschool diploma, but there are tracts where the rate is over 75%. Unemployment rate is lower on average (`r summ_tbl$mean[summ_tbl$variable == "unemp"]`), but can be as high as `r summ_tbl$max[summ_tbl$variable == "unemp"]` These wide ranges highlight substantial variability across communities, which could impact the reliability of our regression model.

In our analysis, we include visualizations including a scatterplot of poverty versus education (@fig-pov-scatter) that shows a positive linear trend. Additionally, we include a second plot coloring points by unemployment (@fig-pov-other) that shows unemployment is also positively correlated with poverty, but with a weaker association than education (@fig-pov-other) [@Wickham2016].

Finally, we note the **limitations** of our simple regression analysis. As with any ACS-derived data, estimates include sampling error, especially in smaller tracts. Variables are bounded between 0% and 100%, which can introduce non-constant variance in regression models, clustering for percentage rounding in the data. Additionally, the education measure applies only to adults 25+, but poverty covers all residents, creating a mismatch in denominators. Finally, geographic clustering of tracts may violate the independence assumption in regression.

# Methods {#sec-methods}
To investigate the relationship between educational attainment and poverty, we adopt a simple linear regression model with poverty as the response and low-educational rate as the predictor. Let 

* $Y_i$ denote the percentage of the population living below 200% of the federal poverty line in tract $i$ (poverty),
* $X_i$ denote the percentage of adults age 25+ without a high-school diploma in tract $i$ (education). We fit the following model:
$$Y_i = \beta_0 + \beta_1X_i + \varepsilon_i \text{ for }i=1,...,n$$ 
where $\beta_0$ is the intercept (expected poverty rate if no adults lack a diploma), $\beta_1$ is the slope (expected change in poverty for one-percentage point increase in $X_i$), and $\varepsilon_i$ is the error error term that encapsulates unobserved factors that impact poverty rates not explained by low-educational attainment percentage [@R2024; @gelman_regression_2021; @kutner2005]. 

As a robustness check of this model, we fit a supplemental multiple linear regression that adds tract unemployment rate $U_i$ as a second explanatory variable:

$$Y_i = \beta_0 + \beta_1X_i + \beta_2U_i +\varepsilon_i \text{ for }i=1,...,n$$ 

where $\beta_2$ is the slope on unemployment. This makes it possible for us to test whether unemployment explains variation in poverty beyond education.

We estimate the parameters of the model ($\beta_0$ and $\beta_1$) using ordinary least squares (OLS) in R with the `lm()` function [@R2024; @kutner2005]. In our case, lm(pov \~ edu, data = to_analyze_df) regresses tract-level poverty rates in the percentage of adults without a high school diploma. The function outputs estimated coefficients, residuals, fitted values, and summary statistics that we accessed with functions like summary() and coef().

**Model choice and considerations**:

When choosing **explanatory variables**, we sought to identify which socioeconomic variables in CalEnviroScreen best explain variation in tract-level poverty. To guide variable selection, we initially ran simple regressions of poverty on each socioeconomic indicator and compared their $R^2$ values. Education (percent without a high school diploma) showed the strongest relationship, with unemployment also showing a moderate association. Based on this testing in addition to prior research linking low educational attainment to poverty in addition to poverty, we chose education as the primary explanatory variable and added unemployment in a secondary model to assess whether it improves explanatory power.

As discussed in @sec-data, the variables are percentages (0â€“100%), so we interpret coefficients as percentage-point changes. We did not complete any **transformations** on them to preserve clarity of interpretations, though we note that bounded outcomes can produce non-normal residuals. 

For this OLS, we adopt the standard linear regression **assumptions**: 
(1) linearity between predictor(s) (educational attainment, unemployment) and outcome (poverty); 
(2) independence between errors across census tracts; 
(3) constant variance of error terms across values of $X_i$; 
(4) approximate normality of the residuals with mean zero.

Some of our possible pitfalls and **limitations** include spatial clustering of tracts (that would violate independence), measurement error from ACS survey margins, and mismatch in denominators (education measured for adults, and poverty measured for all residents).

We completed **model validation** and fit by evaluating $R^2$, $p$-values, and diagnostic plots. We include the diagnostics we used to assess the validity of our regression assumptions using @Wickham2016 and @R2024:

* **Linearity** (1): a straight line in the scatterplot of poverty vs. education (@fig-pov-scatter) and the residuals vs. fitted values plot (@fig-pov-resids) suggest assumption 1 holds [@Wickham2016].
* **Independence of errors** (2): a residuals vs. fitted values plot (@fig-pov-resids) indicate violations of this assumption if there is any clustering or patterns of the points [@Wickham2016].
* **Constant variance** (3): residuals vs. fitted values plot (@fig-pov-resids) with a consistent spread of residuals provide evidence of constant variance, while any funneling of the points suggest a violation of this assumption [@Wickham2016].
* **Normality of residuals** (4): departures from the diagonal line the Qâ€“Q plot (@fig-pov-qq) and skew in the residual histogram (@fig-pov-histo) indicate deviations from normality for the residuals [@qqplotr; @Wickham2016].

@sec-results will show that while the simple model shows a relationship between the variables, our diagnostic checks suggest potential violations of error independence, variance constancy, and normality. Overall, the diagnostics provide evidence about the level of estimated coefficient reliability and inference validity from the model [@kutner2005], and @sec-discussion will highlight how assumption violations impact our model inductions.

In future work, we could address these issues with robust standard errors, variance-stabilizing transformations, or spatial models that explicitly account for geographic dependence. Additionally, like we inspect another factor on poverty rates in the dataset such as unemployment (@fig-pov-other), we could explore other potential predictors of poverty by exploring more robust multiple linear regression models [@Wickham2016]. 

Together, these methods helped us create data cleaning, regression modeling, and visualization that can be reproducible.

# Results {#sec-results}
The simple linear regression of poverty level on education yields the following fitted model:

$\widehat{pov}=$ `r round(intercept,3)` $+$ `r round(slope,3)`
$\times(edu)$ with $R^2=$ `r round(r2,3)` and number of tracts = `r n_obs`.

With a sample size of`r n_obs` tracts, the intercept $\beta_0 \approx$ `r round(intercept,3)`, so for a tract with 100% of its adults holding at least a high school diploma (or 0% lacking one), this model would predict the poverty rate to be an average of `r paste0(round(intercept, 2), "%")` in that tract. The slope $\beta_1 \approx$  `r round(slope,3)`. In other words, each one-percent increase in adults without a high-school diploma per census tract corresponds to an average `r paste0(round(slope, 2), "%")` increase in poverty rate in that tract. The model fit $R^2=$ `r round(r2, 2)`, so about `r paste0(round(r2 * 100, 2), "%")` of the variation in the poverty rate we are measuring is explained by low-education attainment percentage within a census-tract. * The rounded $p$-value for education is `r format.pval(p_val, digits = 3)` ($p < 0.001$), which is far below common thresholds. This indicates that the observed data is not more extreme than the rejection region and the association is statistically significant (meaning this is very unlikely due to chance). Therefore, both coefficients are noteworthy.

From our model, we find a 95% confidence interval for the education slope is approximately equal to `r paste0("[", round(confint(lm_fit)[2,1], 5), ", ",  round(confint(lm_fit)[2,2], 5), "]")`. This means we are 95% confident that for each additional percentage point increase in adults without a high school diploma, the poverty rate of the same census tract will increase between `r round(confint(lm_fit)[2,1], 5)` and `r round(confint(lm_fit)[2,2], 5)` percentage points. We can then assess athe validity of this confidence interval for our primary simple regression with our diagnostic checks in @fig-pov-scatter, @fig-pov-resids, @fig-pov-histo, and @fig-pov-qq. 

Additionally, we conduct a hypothesis test to formally evaluate whether education is associated with poverty. Let our type I error rate be $\alpha = 0.05$. Let us test the following hypotheses: $H_0$: $\beta_1 = 0$ (no relationship between education and poverty) vs. $H_a$: $\beta_1 \neq 0$. 

The t-test for the education coefficient yields a large test statistic ($t \approx 113$) with a p-value less than 0.001. Because the p-value $<\alpha=0.05$, we reject $H_0$ and conclude that low educational attainment is associated with higher poverty rates at the census tract level. As an additional note, when unemployment is included in the supplemental model, the education effect remains relevant, while the unemployment coefficient is comparatively weaker. This suggests that unemployment alone does not explain most of the variation in poverty once education is accounted for.

We added a **supplemental model** with unemployment included to measure if another factor changes our results significantly. The education effect remains positive (`r round(slope2, 3)`), and overall fit improves minimally ($R^2 =$ `r round(r22,3)`, number of tracts `r n_obs2`). When unemployment was added to the regression, the coefficient for education remained remarkable, but unemployment showed a weaker association with poverty. The overall model fit improved only slightly with the increase in $R^2$. This suggests that differences in unemployment rates across tracts do not account for most of the variation in poverty once educational attainment is considered.

```{r fig-pov-scatter}
#| fig-cap: "Scatter plot of percentage of adults without a high school diploma by California census-tract (x-axis) and percentage of population in same tract living under two times the Federal poverty line (FPL) (y-axis) with fitted linear regression model."

eq_text <- sprintf(" regression line: y = %.3f + %.3f x", intercept, slope, r2) # create equation text

#scatter plot with regression
ggplot(to_analyze_df, aes(x = edu, y = pov)) + #plot
  geom_point(alpha = 0.7, size = .5) +
  geom_smooth(method = "lm", se = TRUE, color = "purple") +
  annotate("label", x = -Inf, y = Inf, hjust = -0.1, vjust = 1.1,
           label = eq_text, label.size = 0.2, alpha = 0.5) +
  labs(
    title = "Rates of low-educational attainment vs. poverty",
    subtitle    = "Simple linear regression by census tract (2015â€“2019)",
    x        = "Adults without high school diploma (%)",
    y        = "Population under 2Ã— FPL (%)",
    caption  = "Source: ACS 2015â€“2019; CalEnviroScreen 4.0"
  )
```
```{r fig-pov-other}
#| fig-cap: "Education vs. poverty with points colored by unemployment. The black line shows the simple OLS fit of poverty on education only; color reveals that higher-unemployment tracts tend to lie higher in the scatter, but the fitted line does not adjust for unemployment."

#plot for scatter with unemp included as color only

# Colored by unemployment (for visualization only)
ue_text <- sprintf("Simple fit R^2 = %.3f (no unemp adj.)", r2)  # use r2 from simple model

#scatter plot with regression
ggplot(to_analyze_df_3vars, aes(x = edu, y = pov, color=unemp)) + #plot
  geom_point(alpha = 0.6, size = 0.6) +
  scale_color_viridis_c(name = "Unemployment (%)", option = "plasma")+
  geom_smooth(method = "lm", se = TRUE, color = "black") +
  annotate("text", x = -Inf, y = Inf, hjust = -0.1, vjust = 1.1,
         label = ue_text, size = 3, alpha = 0.7) +
  labs(
    title = "Education vs. poverty, colored by unemployment",
    subtitle    = "Regression using 2019 California census tract data",
    x        = "Adults without high school diploma (%)",
    y        = "Population under 2Ã— FPL (%)",
    caption  = "Source: OEHHA CalEnviroScreen 4.0"
  ) +
  theme_minimal() 
```
```{r fig-pov-resids}
#| fig-cap: "Scatter plot of fitted values (x-axis) and residuals (y-axis) for a simple linear regression with poverty (census-tract population % living under two times the Federal poverty line) as the response and education (% of 25+ age adules withough high school diploma) as the predictor."
resid_df <- data.frame(.fitted = fitted(lm_fit), .resid = resid(lm_fit))
ggplot(resid_df, aes(.fitted, .resid)) +
  geom_point(alpha = .6, size = .6) +
  geom_hline(yintercept = 0, linetype = "dashed", color="darkgreen") +
  geom_smooth(method = "loess", se = FALSE, color = "purple") +
  labs(x = "Fitted values", y = "Residuals", title = "Residuals vs Fitted")
```
```{r fig-pov-qq}
#| fig-cap: "Normal Qâ€“Q plot for the primary model's residuals with poverty as the poverty percentage as response and education as the predictor. Points following the line indicate normality while cny curvature suggest the residuals are deviate from normality"
qqnorm(resid(lm_fit), main = "Normal Qâ€“Q plot (residuals)")
qqline(resid(lm_fit))
```
```{r fig-pov-histo}
#| fig-cap: "Histogram of regression residuals. Bell-shaped and symmetric around zero suggest normality, while skewness and heavy tails indicate show possible deviation from normality"."

ggplot(data.frame(res = resid(lm_fit)), aes(x = res)) +
  geom_histogram(bins = 30) +
  labs(x = "Residual", y = "Count", title = "Histogram of Residuals")
```

# Discussion{#sec-discussion}
**Summary**: The slope is positive and statistically significant, so we can conclude that the poverty rate tends to be higher in locations where there is a higher percentage of adults with lower levels of education than high school diplomas. If the linear regression assumptions are true, the results we see in @sec-results indicate a moderate effect size in the data that suggest low-education attainment is a relevant predictor when predicting poverty rate (although not the only factor) .

**Model assumptions**: Our diagnostic plots show us several violations of the classical linear regression assumptions. Linearity appears reasonable from the @fig-pov-scatter, but independence of errors is unlikely given clustering in @fig-pov-resids, and the residuals show variability and non-normality in @fig-pov-resids and @fig-pov-qq. If the residuals were approximately normal, the black dots would fall close to the straight diagonal line of the Q-Q plot. With thousands of tracts, coefficient estimates are stable, but standard errors may be understated under OLS assumptions. However, the plot bends upwards both in the lower and upper tails. These issues limit the precision of our inference and confidence interval. Additionally, the histogram of residuals (@fig-pov-histo) appears approximately bell-shaped and centered near zero, which supports the assumption that the errors have mean zero. However, the distribution is not perfectly symmetric: the right tail is longer than the left, and there are some extreme positive residuals. This indicates mild right skew and the presence of high-poverty tracts where the model underpredicts. While the residuals do not follow a perfect normal distribution, the large sample size (n = `r n_obs`) reduces concerns about inference validity due to the Central Limit Theorem. Nevertheless, the skewness suggests that robust standard errors or a variance-stabilizing transformation (e.g., square-root of the response) might provide more reliable inference in future analyses. Overall though, the non-normality and changes in variance, our 95% confidence interval should only be drawn cautiously, so we might want to consider using more robust standard errors.

**Comparing education and unemployment**: When we added unemployment to the model, it did not meaningfully change the estimated effect of education. The unemployment has a weaker positive association with poverty, but the education coefficient remains consequential. This result challenges a possible assumption that unemployment is a primary driver of poverty. We see from @fig-pov-other that a high percentage of individuals are employed but remain below twice the federal poverty threshold @OEHHA2021 set. This indicates situations where many individuals are working but still fall below the poverty threshold here. By comparison, educational attainment shows a stronger and more consistent relationship with poverty, which highlights its relevance as a key factor of socioeconomic well-being.

Generally speaking, the simple linear regression analysis for this research question can only draw questionable inferences, so the linear regression is likely not a full picture of the relationship between education and poverty. With that being said, we did see that the positive correlation in the linear regression model is likely statistically significant due to the p-value and $R^2$ value. Therefore, there is a positive relationship between low education attainment percentage and poverty rate percentage. 

**Implications**: We see that the findings support noting education as a factor in determining predictors of poverty in datasets like CalEnviroScreen, which are used to identify communities experiencing socioeconomic and environmental burdens. Policymakers and advocates can use this data to inform investments in education, workforce support, and pollution reduction to advance environmental justice and public health.

**Limitations**: We used cross-sectional, observational data, which limits our causal inferences. The nature of tract-level geographical dependence of the data likely violates the independence assumption. Additionally, the bounded percentage outcomes produce heteroskedasticity. Finally the ACS sampling error introduces measurement error. 

On a broader level, a limitation of our analysis is the definition of poverty. CalEnviroScreen uses 200% of the federal poverty level (FPL) to account for Californiaâ€™s high cost of living. This is a more appropriate benchmark than the unadjusted FPL, it does not capture wide regional differences within the state. For example, housing costs in the Bay Area vs rural areas of California have a large range. Consequently, the same income threshold may reflect very different levels of economic hardship depending on location. This limitation means that our poverty measure may overstate poverty in some rural areas and understate it in high-cost metropolitan regions, which could feasibly introduce additional variation not explained by education or unemployment in our models.
Another limitation is that the education measure applies only to adults aged 25 and older, but the poverty measure covers the entire population. This mismatch means that our predictor and outcome are not measured on exactly the same group. For example, tracts with many children in poverty but relatively well-educated adults could weaken the observed association. On the other side, tracts with low adult education may experience higher poverty rates even among children and elderly residents who are not part of the education measure. This difference in denominators introduces another possible measurement error into our regression.

# References
::: {#refs} :::
